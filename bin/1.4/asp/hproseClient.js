/*
 * Compressed by JSA(www.xidea.org)
 */
var HproseResultMode={Normal:0,Serialized:1,Raw:2,RawWithEndTag:3};function HproseException($){this.message=$;this.description=$}HproseException.prototype=new Error;HproseException.prototype.name="HproseException";function HproseFilter(){this.inputFilter=function($){return $};this.outputFilter=function($){return $}}var HproseUtil={isDictionary:function($){return(($!=null)&&(typeof($)=="object")&&($ instanceof ActiveXObject)&&(typeof($.Add)=="unknown")&&(typeof($.Exists)=="unknown")&&(typeof($.Items)=="unknown")&&(typeof($.Keys)=="unknown")&&(typeof($.Remove)=="unknown")&&(typeof($.RemoveAll)=="unknown")&&(typeof($.Count)=="number")&&(typeof($.Item)=="unknown")&&(typeof($.Key)=="unknown"))},isVBArray:function($){return(($!=null)&&(typeof($)=="unknown")&&($.constructor==VBArray)&&(typeof($.dimensions)=="function")&&(typeof($.getItem)=="function")&&(typeof($.lbound)=="function")&&(typeof($.toArray)=="function")&&(typeof($.ubound)=="function"))},toObject:function(_){var B=(new VBArray(_.Keys())).toArray(),$={};for(var A=0;A<B.length;A++)if(this.isDictionary(_(B[A])))$[B[A]]=this.toObject(_(B[A]));else if(this.isVBArray(_(B[A])))$[B[A]]=this.toJSArray(_(B[A]));else $[B[A]]=_(B[A]);return $},toDictionary:function(_){var A,$;$=new ActiveXObject("Scripting.Dictionary");for(A in _)$.Add(A,_[A]);return $},toJSArray:function(_){function A($,C,E){var B=$.dimensions();if(B>C){E[C]=0;C++}var F=$.lbound(C),D=$.ubound(C),_=[];for(var G=F;G<=D;G++){E[C-1]=G;if(B==C)_[G]=$.getItem.apply($,E);else _[G]=A($,C,E)}return _}var $=new VBArray(_);if($.dimensions()==1&&$.lbound()==0)return $.toArray();return A($,0,[])},toVBArray:function($){return this.toDictionary($).Items()},binaryToString:function(_,C){try{var D=2,$=1,B=new ActiveXObject("ADODB.Stream");B.Type=$;B.Open();B.Write(_);B.Position=0;B.Type=D;if(C)B.CharSet=C;else B.CharSet="UTF-8";return B.ReadText()}catch(A){return""}}};function HproseStringInputStream($){var A=0,_=$.length;this.getc=function(){return $.charAt(A++)};this.read=function(B){var _=$.substr(A,B);this.skip(B);return _};this.skip=function($){A+=$};this.readuntil=function(C){var D=$.indexOf(C,A),B;if(D!==-1){B=$.substr(A,D-A);A=D+C.length}else{B=$.substr(A);A=_}return B};this.rawData=function(){return $}}function HproseStringOutputStream($){if($===undefined)$="";var _=[$],A=_.length;this.write=function($){_[A++]=$};this.mark=function(){$=this.toString()};this.reset=function(){_=[$]};this.clear=function(){_=[]};this.toString=function(){return _.join("")}}var HproseTags={TagInteger:"i",TagLong:"l",TagDouble:"d",TagNull:"n",TagEmpty:"e",TagTrue:"t",TagFalse:"f",TagNaN:"N",TagInfinity:"I",TagDate:"D",TagTime:"T",TagUTC:"Z",TagUTF8Char:"u",TagString:"s",TagGuid:"g",TagList:"a",TagMap:"m",TagClass:"c",TagObject:"o",TagRef:"r",TagPos:"+",TagNeg:"-",TagSemicolon:";",TagOpenbrace:"{",TagClosebrace:"}",TagQuote:"\"",TagPoint:".",TagFunctions:"F",TagCall:"C",TagResult:"R",TagArgument:"A",TagError:"E",TagEnd:"z"},HproseClassManager=new(function(){var _={},$=new ActiveXObject("Scripting.Dictionary");this.register=function(A,B){$.Item(A)=B;_[B]=A};this.getClassAlias=function(_){return $.Item(_)};this.getClass=function($){return _[$]};this.register(Object,"Object")})(),HproseRawReader,HproseSimpleReader,HproseReader,HproseSimpleWriter,HproseWriter;(function(){function freeEval(str){return eval(str)}(function(){var J=HproseUtil,R=HproseTags,H=HproseException,K=HproseClassManager;function D(B,_){var $=B.length;for(var A=0;A<$;A++)if(B[A]===_)return A;return-1}function L(B,D,F,A){if(F<D.length){var E=D[F];B[E]=A;var _=L(B,D,F+1,".");if(F+1<D.length)if(_==null)_=L(B,D,F+1,"_");return _}var C=B.join("");try{if(freeEval("typeof("+C+") == \"function\""))return freeEval(C);else return null}catch($){return null}}function $(A){var $=K.getClass(A);if($)return $;if(freeEval("typeof("+A+") == \"function\"")){$=freeEval(A);K.register($,A);return $}var B=[],C=A.indexOf("_");while(C>-1){B[B.length]=C;C=A.indexOf("_",C+1)}if(B.length>0){var _=A.split("");$=L(_,B,0,".");if($==null)$=L(_,B,0,"_");if($!=null){K.register($,A);return $}}$=function(){this.getClassName=function(){return A}};K.register($,A);return $}var B=function(){var $={};for(var _ in[])$[_]=true;return $}(),_=function(){var $={};for(var _ in{})$[_]=true;return $}();function F($){switch($.toString()){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return true}return false}function O($){var _=$.length;for(var A=($.charAt(0)=="-")?1:0;A<_;A++)if(!F($.charAt(A)))return false;return($!="-")}function C(_){var $=_.toString(),A=$.length;return((A<12)&&O($)&&!(_<-2147483648||_>2147483647))}function Q($){return(Object.prototype.toString.apply($)==="[object Array]")}function E(B){if(B===undefined||B.constructor===undefined)return"Object";var $=B.constructor,A=K.getClassAlias($);if(A)return A;var _=$.toString();A=_.substr(0,_.indexOf("(")).replace(/(^\s*function\s*)|(\s*$)/ig,"");if(A==""||A=="Object")return(typeof(B.getClassName)=="function")?B.getClassName():"Object";if(A!="Object")K.register($,A);return A}function N(_,$){if(_&&$)throw new H("Tag '"+$+"' expected, but '"+_+"' found in stream");else if(_)throw new H("Unexpected serialize tag '"+_+"' in stream");else throw new H("No byte found in stream")}HproseRawReader=function A(_){function B(G,A){if(G===undefined)G=new HproseStringOutputStream();if(A===undefined)A=_.getc();switch(A){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case HproseTags.TagNull:case HproseTags.TagEmpty:case HproseTags.TagTrue:case HproseTags.TagFalse:case HproseTags.TagNaN:G.write(A);break;case HproseTags.TagInfinity:case HproseTags.TagUTF8Char:G.write(A);G.write(_.getc());break;case HproseTags.TagInteger:case HproseTags.TagLong:case HproseTags.TagDouble:case HproseTags.TagRef:D(G,A);break;case HproseTags.TagDate:case HproseTags.TagTime:C(G,A);break;case HproseTags.TagString:E(G,A);break;case HproseTags.TagGuid:F(G,A);break;case HproseTags.TagList:case HproseTags.TagMap:case HproseTags.TagObject:$(G,A);break;case HproseTags.TagClass:$(G,A);B(G);break;case HproseTags.TagError:G.write(A);B(G);break;default:N(A)}return G}function D(A,$){A.write($);do{$=_.getc();A.write($)}while($!=HproseTags.TagSemicolon)}function C(A,$){A.write($);do{$=_.getc();A.write($)}while($!=HproseTags.TagSemicolon&&$!=HproseTags.TagUTC)}function E(C,A){C.write(A);var $=_.readuntil(HproseTags.TagQuote);C.write($);C.write(HproseTags.TagQuote);var B=0;if($.length>0)B=parseInt($);C.write(_.read(B+1))}function F(A,$){A.write($);A.write(_.read(38))}function $(A,$){A.write($);do{$=_.getc();A.write($)}while($!=HproseTags.TagOpenbrace);while(($=_.getc())!=HproseTags.TagClosebrace)B(A,$);A.write($)}this.readRaw=B};HproseSimpleReader=function I(C,T){HproseRawReader.call(this,C);var a=[];function B(_,$){if($===undefined)$=C.getc();if($!=_)N($,_)}function K($,_){if(_===undefined)_=C.getc();if($.indexOf(_)>=0)return _;N(_,$)}function A(_){var $=C.readuntil(_);if($.length==0)return 0;return parseInt($)}function Z($){if($===undefined)$=C.getc();switch($){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case R.TagInteger:return M();case R.TagLong:return f();case R.TagDouble:return Y();case R.TagNull:return null;case R.TagEmpty:return"";case R.TagTrue:return true;case R.TagFalse:return false;case R.TagNaN:return NaN;case R.TagInfinity:return v();case R.TagDate:return this.readDateWithoutTag();case R.TagTime:return this.readTimeWithoutTag();case R.TagUTF8Char:return C.getc();case R.TagString:return this.readStringWithoutTag();case R.TagGuid:return this.readGuidWithoutTag();case R.TagList:return this.readListWithoutTag();case R.TagMap:return this.readMapWithoutTag();case R.TagClass:this.readClass();return this.readObject();case R.TagObject:return this.readObjectWithoutTag();case R.TagRef:return this.readRef();case R.TagError:throw new H(this.readString());default:N($)}}function M(){return A(R.TagSemicolon)}function V(){var $=C.getc();switch($){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case R.TagInteger:return M();default:N($)}}function f(){return C.readuntil(R.TagSemicolon)}function U(){var $=C.getc();switch($){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case R.TagInteger:case R.TagLong:return f();default:N($)}}function Y(){return parseFloat(C.readuntil(R.TagSemicolon))}function l(){var $=C.getc();switch($){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case R.TagInteger:case R.TagLong:case R.TagDouble:return Y();case R.TagNaN:return NaN;case R.TagInfinity:return v();default:N($)}}function E(){B(R.TagNaN);return NaN}function v(){return((C.getc()==R.TagNeg)?-Infinity:Infinity)}function j(){B(R.TagInfinity);return v()}function g(){B(R.TagNull);return null}function D(){B(R.TagEmpty);return""}function L(){var $=C.getc();switch($){case R.TagTrue:return true;case R.TagFalse:return false;default:N($)}}function t(){var E=parseInt(C.read(4)),D=parseInt(C.read(2))-1,G=parseInt(C.read(2)),H,B=C.getc();if(B==R.TagTime){var F=parseInt(C.read(2)),$=parseInt(C.read(2)),_=parseInt(C.read(2)),A=0;B=C.getc();if(B==R.TagPoint){A=parseInt(C.read(3));B=C.getc();if((B>="0")&&(B<="9")){C.skip(2);B=C.getc();if((B>="0")&&(B<="9")){C.skip(2);B=C.getc()}}}if(B==R.TagUTC)H=new Date(Date.UTC(E,D,G,F,$,_,A));else H=new Date(E,D,G,F,$,_,A)}else if(B==R.TagUTC)H=new Date(Date.UTC(E,D,G));else H=new Date(E,D,G);if(T)H=H.getVarDate();return H}function e(){var $=C.getc();switch($){case R.TagDate:return this.readDateWithoutTag();case R.TagRef:return this.readRef();default:N($)}}function o(){var _,E=parseInt(C.read(2)),$=parseInt(C.read(2)),A=parseInt(C.read(2)),D=0,B=C.getc();if(B==R.TagPoint){D=parseInt(C.read(3));B=C.getc();if((B>="0")&&(B<="9")){C.skip(2);B=C.getc();if((B>="0")&&(B<="9")){C.skip(2);B=C.getc()}}}if(B==R.TagUTC){if(T)_=new Date(Date.UTC(1899,11,30,E,$,A,D)).getVarDate();else _=new Date(Date.UTC(1970,0,1,E,$,A,D))}else if(T)_=new Date(1899,11,30,E,$,A,D).getVarDate();else _=new Date(1970,0,1,E,$,A,D);return _}function W(){var $=C.getc();switch($){case R.TagTime:return this.readTimeWithoutTag();case R.TagRef:return this.readRef();default:N($)}}function i(){return C.getc()}function r(){B(R.TagUTF8Char);return C.getc()}function d(){var $=C.read(A(R.TagQuote));C.skip(1);return $}function X(){var $=C.getc();switch($){case R.TagString:return this.readStringWithoutTag();case R.TagRef:return this.readRef();default:N($)}}function n(){C.skip(1);var $=C.read(36);C.skip(1);return $}function c(){var $=C.getc();switch($){case R.TagGuid:return this.readGuidWithoutTag();case R.TagRef:return this.readRef();default:N($)}}function _(){return[]}function u(_){var $=A(R.TagOpenbrace);for(var B=0;B<$;B++)_[B]=this.unserialize();C.skip(1);if(T)_=J.toVBArray(_);return _}function G(){return this.readListEnd(this.readListBegin())}function O(){var $=C.getc();switch($){case R.TagList:return this.readListWithoutTag();case R.TagRef:return this.readRef();default:N($)}}function s(){if(T)return new ActiveXObject("Scripting.Dictionary");return{}}function S(B){var $=A(R.TagOpenbrace);for(var E=0;E<$;E++){var D=this.unserialize(),_=this.unserialize();if(T)B.Add(D,_);else B[D]=_}C.skip(1);return B}function P(){return this.readMapEnd(this.readMapBegin())}function h(){var $=C.getc();switch($){case R.TagMap:return this.readMapWithoutTag();case R.TagRef:return this.readRef();default:N($)}}function k(){var $=a[A(R.TagOpenbrace)],_=new $.classname();return{obj:_,cls:$}}function p(_,$){for(var A=0;A<$.count;A++)_[$.fields[A]]=this.unserialize();C.skip(1);return _}function q(){var $=this.readObjectBegin();return this.readObjectEnd($.obj,$.cls)}function b(){var $=C.getc();switch($){case R.TagClass:this.readClass();return this.readObject();case R.TagObject:return this.readObjectWithoutTag();case R.TagRef:return this.readRef();default:N($)}}function F(){var B=d(),_=A(R.TagOpenbrace),E=[];for(var D=0;D<_;D++)E[D]=this.readString();C.skip(1);B=$(B);a[a.length]={classname:B,count:_,fields:E}}function m(){N(R.TagRef)}function Q(){a.length=0}this.checkTag=B;this.checkTags=K;this.unserialize=Z;this.readInteger=V;this.readLong=U;this.readDouble=l;this.readNaN=E;this.readInfinity=j;this.readNull=g;this.readEmpty=D;this.readBoolean=L;this.readDateWithoutTag=t;this.readDate=e;this.readTimeWithoutTag=o;this.readTime=W;this.readUTF8Char=r;this.readStringWithoutTag=d;this.readString=X;this.readGuidWithoutTag=n;this.readGuid=c;this.readListBegin=_;this.readListEnd=u;this.readListWithoutTag=G;this.readList=O;this.readMapBegin=s;this.readMapEnd=S;this.readMapWithoutTag=P;this.readMap=h;this.readObjectBegin=k;this.readObjectEnd=p;this.readObjectWithoutTag=q;this.readObject=b;this.readClass=F;this.readRef=m;this.reset=Q};HproseReader=function G(B,_){HproseSimpleReader.call(this,B,_);var A=[];function $(_){var $=B.readuntil(_);if($.length==0)return 0;return parseInt($)}var H=this.readDateWithoutTag;this.readDateWithoutTag=function(){return A[A.length]=H()};var D=this.readTimeWithoutTag;this.readTimeWithoutTag=function(){return A[A.length]=D()};var F=this.readStringWithoutTag;this.readStringWithoutTag=function(){return A[A.length]=F()};var C=this.readGuidWithoutTag;this.readGuidWithoutTag=function(){return A[A.length]=C()};this.readListWithoutTag=function(){var B=this.readListBegin(),$=A.length;A[$]=B;B=this.readListEnd(B);if(_)A[$]=B;return B};this.readMapWithoutTag=function(){return this.readMapEnd(A[A.length]=this.readMapBegin())};this.readObjectWithoutTag=function(){var $=this.readObjectBegin();A[A.length]=$.obj;return this.readObjectEnd($.obj,$.cls)};this.readRef=function(){return A[$(R.TagSemicolon)]};var E=this.reset;this.reset=function(){E();A.length=0}};HproseSimpleWriter=function P($){var f={},m=[];function d(A){if(A===undefined||A===null||A.constructor==Function)return L();if(A==="")return l();if(typeof(A)=="date")return G(A);if(J.isDictionary(A))return this.writeDictWithRef(A);if(J.isVBArray(A))A=J.toJSArray(A);switch(A.constructor){case Boolean:n(A);break;case Number:F(A)?$.write(A):C(A)?a(A):M(A);break;case String:A.length==1?i(A):this.writeStringWithRef(A);break;case Date:this.writeDateWithRef(A);break;default:if(Array.isArray(A))this.writeListWithRef(A);else{var _=E(A);if(_=="Object")this.writeMapWithRef(A);else this.writeObjectWithRef(A)}}}function a(_){$.write(R.TagInteger+_+R.TagSemicolon)}function N(_){$.write(R.TagLong+_+R.TagSemicolon)}function M(_){if(isNaN(_))p();else if(isFinite(_))$.write(R.TagDouble+_+R.TagSemicolon);else g(_>0)}function p(){$.write(R.TagNaN)}function g(_){$.write(R.TagInfinity+(_?R.TagPos:R.TagNeg))}function L(){$.write(R.TagNull)}function l(){$.write(R.TagEmpty)}function n(_){$.write(_?R.TagTrue:R.TagFalse)}function K(G){var D=("0000"+G.getUTCFullYear()).slice(-4),C=("00"+(G.getUTCMonth()+1)).slice(-2),F=("00"+G.getUTCDate()).slice(-2),E=("00"+G.getUTCHours()).slice(-2),_=("00"+G.getUTCMinutes()).slice(-2),A=("00"+G.getUTCSeconds()).slice(-2),B=("000"+G.getUTCMilliseconds()).slice(-3);$.write(R.TagDate+D+C+F+R.TagTime+E+_+A);if(B!="000")$.write(R.TagPoint+B);$.write(R.TagUTC)}function j($){if(!this.writeRef($))this.writeUTCDate($)}function Y(I,J,H,A){var E=("0000"+I.getFullYear()).slice(-4),D=("00"+(I.getMonth()+1)).slice(-2),G=("00"+I.getDate()).slice(-2),F=("00"+I.getHours()).slice(-2),_=("00"+I.getMinutes()).slice(-2),B=("00"+I.getSeconds()).slice(-2),C=("000"+I.getMilliseconds()).slice(-3);if((F=="00")&&(_=="00")&&(B=="00")&&(C=="000"))$.write(R.TagDate+E+D+G);else if((E==J)&&(D==H)&&(G==A)){$.write(R.TagTime+F+_+B);if(C!="000")$.write(R.TagPoint+C)}else{$.write(R.TagDate+E+D+G+R.TagTime+F+_+B);if(C!="000")$.write(R.TagPoint+C)}$.write(R.TagSemicolon)}function G($){Y(new Date($),"1899","12","30")}function D($){Y($,"1970","01","01")}function h($){if(!this.writeRef($))this.writeDate($)}function T(A){var D=("00"+A.getHours()).slice(-2),_=("00"+A.getMinutes()).slice(-2),B=("00"+A.getSeconds()).slice(-2),C=("000"+A.getMilliseconds()).slice(-3);$.write(R.TagTime+D+_+B);if(C!="000")$.write(R.TagPoint+C);$.write(R.TagSemicolon)}function b($){if(!this.writeRef($))this.writeTime($)}function i(_){$.write(R.TagUTF8Char+_)}function k(_){$.write(R.TagString+(_.length>0?_.length:"")+R.TagQuote+_+R.TagQuote)}function X($){if(!this.writeRef($))this.writeString($)}function e(A){var _=A.length;$.write(R.TagList+(_>0?_:"")+R.TagOpenbrace);for(var B=0;B<_;B++)this.serialize(A[B]);$.write(R.TagClosebrace)}function I($){if(!this.writeRef($))this.writeList($)}function S(_){var C=(new VBArray(_.Keys())).toArray(),A=C.length;$.write(R.TagMap+(A>0?A:"")+R.TagOpenbrace);for(var B=0;B<A;B++){this.serialize(C[B]);this.serialize(_.Item(C[B]))}$.write(R.TagClosebrace)}function Z($){if(!this.writeRef($))this.writeDict($)}function A(C){var F=[];for(var D in C)if(typeof(C[D])!="function"&&(typeof(C[D])!="unknown"||J.isVBArray(C[D]))&&!_[D]&&!B[D])F[F.length]=D;var A=F.length;$.write(R.TagMap+(A>0?A:"")+R.TagOpenbrace);for(var E=0;E<A;E++){this.serialize(F[E]);this.serialize(C[F[E]])}$.write(R.TagClosebrace)}function H($){if(!this.writeRef($))this.writeMap($)}function W(C){var B=E(C),A=f[B],F;if(A!==undefined)F=m[A];else{F=[];for(var D in C)if(typeof(C[D])!="function"&&!_[D])F[F.length]=D.toString();A=U.call(this,B,F)}$.write(R.TagObject+A+R.TagOpenbrace);return F}function O(A,C){var _=C.length;for(var B=0;B<_;B++)this.serialize(A[C[B]]);$.write(R.TagClosebrace)}function Q($){this.writeObjectEnd($,this.writeObjectBegin($))}function c($){if(!this.writeRef($))this.writeObject($)}function U(B,D){var A=D.length;$.write(R.TagClass+B.length+R.TagQuote+B+R.TagQuote+(A>0?A:"")+R.TagOpenbrace);for(var C=0;C<A;C++)this.writeString(D[C]);$.write(R.TagClosebrace);var _=m.length;f[B]=_;m[_]=D;return _}function o($){return false}function V(){f={};m.length=0}this.serialize=d;this.writeInteger=a;this.writeLong=N;this.writeDouble=M;this.writeNaN=p;this.writeInfinity=g;this.writeNull=L;this.writeEmpty=l;this.writeBoolean=n;this.writeUTCDate=K;this.writeUTCDateWithRef=j;this.writeVBSDate=G;this.writeDate=D;this.writeDateWithRef=h;this.writeTime=T;this.writeTimeWithRef=b;this.writeUTF8Char=i;this.writeString=k;this.writeStringWithRef=X;this.writeList=e;this.writeListWithRef=I;this.writeDict=S;this.writeDictWithRef=Z;this.writeMap=A;this.writeMapWithRef=H;this.writeObjectBegin=W;this.writeObjectEnd=O;this.writeObject=Q;this.writeObjectWithRef=c;this.writeRef=o;this.reset=V};HproseWriter=function M(A){HproseSimpleWriter.call(this,A);var _=new ActiveXObject("Scripting.Dictionary"),F=0,J=this.writeUTCDate;this.writeUTCDate=function($){_.Item($)=F++;J.call(this,$)};var H=this.writeVBSDate;this.writeVBSDate=function($){_.Item($)=F++;H.call(this,$)};var E=this.writeDate;this.writeDate=function($){_.Item($)=F++;E.call(this,$)};var C=this.writeTime;this.writeTime=function($){_.Item($)=F++;C.call(this,$)};var G=this.writeString;this.writeString=function($){_.Item($)=F++;G.call(this,$)};var D=this.writeList;this.writeList=function($){_.Item($)=F++;D.call(this,$)};var $=this.writeDict;this.writeDict=function(A){_.Item(A)=F++;$.call(this,A)};var B=this.writeMap;this.writeMap=function($){_.Item($)=F++;B.call(this,$)};this.writeObject=function($){var A=this.writeObjectBegin($);_.Item($)=F++;this.writeObjectEnd($,A)};this.writeRef=function($){if(_.Exists($)){A.write(R.TagRef+_.Item($)+R.TagSemicolon);return true}return false};var I=this.reset;this.reset=function(){I();_.RemoveAll();F=0}}})()})();var HproseFormatter={serialize:function(B,_){var $=new HproseStringOutputStream(),A=(_?new HproseSimpleWriter($):new HproseWriter($));A.serialize(B);return $.toString()},unserialize:function(B,_){var $=new HproseStringInputStream(B),A=(_?new HproseSimpleReader($):new HproseReader($));return A.unserialize()}},HproseHttpClient=(function(){var J=HproseResultMode,Z=HproseException,I=HproseFilter,H=HproseStringInputStream,Y=HproseStringOutputStream,X=HproseSimpleReader,F=HproseReader,V=HproseSimpleWriter,Q=HproseWriter,B=HproseTags,d=HproseFormatter,E="undefined",R="boolean",N="string",$="number",b="function",G="_OnError",K="_onError",A="_onerror",O="_Callback",e="_callback",L="_OnSuccess",M="_onSuccess",T="_onsuccess",D=false,C={},W=null;function _(){if(W!=null)return new ActiveXObject(W);else{var $=["MSXML2.ServerXMLHTTP.6.0","MSXML2.ServerXMLHTTP.5.0","MSXML2.ServerXMLHTTP.4.0","MSXML2.ServerXMLHTTP.3.0","MSXML2.ServerXMLHTTP"],B=$.length,A;for(var C=0;C<B;C++){try{A=new ActiveXObject($[C]);W=$[C];return A}catch(_){}}return null}}function c(_,A){for(var I=0;I<_.length;I++){var H=_[I].split(":",2),B=H[0].toLowerCase(),E=H[1];if((B=="set-cookie")||(B=="set-cookie2")){var G=E.replace(/(^\s*)|(\s*$)/g,"").split(";"),$={};E=G[0].replace(/(^\s*)|(\s*$)/g,"").split("=",2);if(E[1]===undefined)E[1]=null;$["name"]=E[0];$["value"]=E[1];for(var F=1;F<G.length;F++){E=G[F].replace(/(^\s*)|(\s*$)/g,"").split("=",2);if(E[1]===undefined)E[1]=null;$[E[0].toUpperCase()]=E[1]}if($["PATH"]){if($["PATH"].charAt(0)=="\"")$["PATH"]=$["PATH"].substr(1);if($["PATH"].charAt($["PATH"].length-1)=="\"")$["PATH"]=$["PATH"].substr(0,$["PATH"].length-1)}else $["PATH"]="/";if($["EXPIRES"])$["EXPIRES"]=Date.parse($["EXPIRES"]);if($["DOMAIN"])$["DOMAIN"]=$["DOMAIN"].toLowerCase();else $["DOMAIN"]=A;$["SECURE"]=($["SECURE"]!==undefined);if(C[$["DOMAIN"]]===undefined)C[$["DOMAIN"]]={};C[$["DOMAIN"]][$["name"]]=$;if(D)Session("HPROSE_COOKIE_MANAGER")=C}}}function S(_,F,E){var G=[];for(var D in C)if(_.indexOf(D)>-1){var A=[];for(var B in C[D]){var $=C[D][B];if($["EXPIRES"]&&((new Date()).getTime()>$["EXPIRES"]))A.push(B);else if(F.indexOf($["PATH"])===0)if(((E&&$["SECURE"])||!$["SECURE"])&&($["value"]!==null))G.push($["name"]+"="+$["value"])}for(var H in A)delete C[D][A[H]]}if(G.length>0)return G.join("; ");return""}function U(C,_,D){if(C.status==200){var $=C.getAllResponseHeaders().split("\r\n");c($,_);return D.inputFilter(C.responseText)}else{var A=C.status+":"+C.statusText;return B.TagError+d.serialize(A,true)+B.TagEnd}}function P(F,G,D,K,$,O,P,Q,L){var B,M,C,J;if(F.substr(0,7).toLowerCase()=="http://"){C=false;J=7}else if(F.substr(0,8).toLowerCase()=="https://"){C=true;J=8}if(J>0){B=F.substring(J,F.indexOf("/",J));var E=B.match(/^([^:]*):([^@]*)@(.*)$/);if(E!=null)B=E[3];M=F.substr(F.indexOf("/",J))}else throw new Z("Url must be an absolute path.");var N=_();N.setTimeouts(P,P,P,P);if(K){try{N.setProxy(2,K);if($)N.setProxyCredentials($,O)}catch(A){}}if(L){N.open("POST",F,true);N.onreadystatechange=function(){if(N.readyState==4)L(U(N,B,Q))}}else N.open("POST",F,false);for(var I in G)N.setRequestHeader(I,G[I]);var H=S(B,M,C);if(H!="")N.setRequestHeader("Cookie",H);N.send(Q.outputFilter(D));if(L)return N;else return U(N,B,Q)}function a(d,C,_){var D={"Content-Type":"application/hprose; charset=utf-8"},n,W,g,E,i=30000,j=false,c=false,S=[],f=new I(),U=this;this.useService=function(B,$,A){if(typeof($)==R&&A===undefined)A=$;var _=this;if(A)_={};if(B===undefined)return new Z("You should set server url first!");n=B;if(typeof($)==N||($&&$.constructor==Object))$=[$];if(Object.prototype.toString.apply($)==="[object Array]")o.call(_,$);else k.apply(_);return _};this.invoke=function(){var $=arguments,_=Array.prototype.shift.apply($);return h.call(this,_,$)};this.setHeader=function(_,A){var $=_.toLowerCase();if($!="content-type"&&$!="content-length"&&$!="host")if(A)D[_]=A;else delete D[_]};this.setProxy=function(A,$,_,F){if(!A)W=null;else if($===undefined){var C=0;if(A.substr(0,7).toLowerCase()=="http://")C=7;else if(A.substr(0,6).toLowerCase()=="tcp://")C=6;var B=A.indexOf("/",C);if(B>0){A=A.substring(C,B);var D=A.match(/^([^:]*):([^@]*)@(.*)$/);if(D!=null){g=decodeURIComponent(D[1]);E=decodeURIComponent(D[2]);A=D[3]}}W=A}else{W=A+":"+$;if(_!==undefined&&F!==undefined){g=_;E=F}}};this.setTimeout=function($){i=$};this.getTimeout=function(){return i};this.getByRef=function(){return j};this.setByRef=function($){if($===undefined)$=true;j=$};this.setFilter=function($){f=$};this.getSimpleMode=function(){return c};this.setSimpleMode=function($){if($===undefined)$=true;c=$};this.onError=function(_,$){};this.waitForResponse=function(C){for(var D=0,B=S.length;D<B;D++)if(S[D]){var A=S[D];if(C===undefined)A.waitForResponse();else{if(C<0)return;var _=new Date();A.waitForResponse(C/1000);var $=new Date();C-=$.getTime()-_.getTime()}}};function k(){var $=P(n,D,B.TagEnd,W,g,E,i,f),C=new H($),G=new X(C,_),F=G.checkTags(B.TagFunctions+B.TagError);switch(F){case B.TagFunctions:var A=G.readList();G.checkTag(B.TagEnd);o.call(this,A);break;case B.TagError:throw new Z(G.readString());break}}function m(_){var $=this;return function(){return h.call($,_,arguments)}}function l(B,E,_,$){if(B[_]!==undefined)return;B[_]={};if(typeof($)==N||$.constructor==Object)$=[$];if(Object.prototype.toString.apply($)==="[object Array]")for(var D=0;D<$.length;D++){var C=$[D];if(typeof(C)==N)B[_][C]=m.call(this,E+_+"_"+C);else for(var A in C)l.call(this,B[_],_+"_",A,C[A])}}function o(_){for(var B=0;B<_.length;B++){var $=_[B];if(typeof($)==N){if(this[$]===undefined)this[$]=m($)}else for(var A in $)l.call(this,this,"",A,$[A])}}function a($,L,G,K){var A=null;if(K==J.RawWithEndTag)A=$;else if(K==J.Raw)A=$.substr(0,$.length-1);else{var C=new H($),M=new F(C,_),E,D=null;while((E=M.checkTags(B.TagResult+B.TagArgument+B.TagError+B.TagEnd))!==B.TagEnd)switch(E){case B.TagResult:if(K==J.Serialized)A=M.readRaw().toString();else A=M.unserialize();break;case B.TagArgument:M.reset();var I=M.readList();for(var N=0;N<I.length;N++)G[N]=I[N];break;case B.TagError:M.reset();D=new Z(M.readString());break}if(D!=null)throw D}return A}function h(l,F){var m=J.Normal,I=j,H=c,X=l.toLowerCase(),N=this[l+G]||this[l+K]||this[l+A]||this[X+G]||this[X+K]||this[X+A]||U[l+G]||U[l+K]||U[l+A]||U[X+G]||U[X+K]||U[X+A],k=this[l+O]||this[l+e]||this[l+L]||this[l+M]||this[l+T]||this[X+O]||this[X+e]||this[X+L]||this[X+M]||this[X+T]||U[l+O]||U[l+e]||U[l+L]||U[l+M]||U[l+T]||U[X+O]||U[X+e]||U[X+L]||U[X+M]||U[X+T],C=F.length;if(typeof(F[C-1])==R&&typeof(F[C-2])==$&&typeof(F[C-3])==R&&typeof(F[C-4])==b&&typeof(F[C-5])==b){H=F[C-1];m=F[C-2];I=F[C-3];N=F[C-4];k=F[C-5];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];delete F[C-5];F.length-=5}else if(typeof(F[C-1])==R&&typeof(F[C-2])==$&&typeof(F[C-3])==b&&typeof(F[C-4])==b){H=F[C-1];m=F[C-2];N=F[C-3];k=F[C-4];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];F.length-=4}else if(typeof(F[C-1])==$&&typeof(F[C-2])==R&&typeof(F[C-3])==b&&typeof(F[C-4])==b){m=F[C-1];I=F[C-2];N=F[C-3];k=F[C-4];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];F.length-=4}else if(typeof(F[C-1])==R&&typeof(F[C-2])==R&&typeof(F[C-3])==b&&typeof(F[C-4])==b){H=F[C-1];I=F[C-2];N=F[C-3];k=F[C-4];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];F.length-=4}else if(typeof(F[C-1])==R&&typeof(F[C-2])==b&&typeof(F[C-3])==b){I=F[C-1];N=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==$&&typeof(F[C-2])==b&&typeof(F[C-3])==b){m=F[C-1];N=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==b&&typeof(F[C-2])==b){N=F[C-1];k=F[C-2];delete F[C-1];delete F[C-2];F.length-=2}else if(typeof(F[C-1])==R&&typeof(F[C-2])==$&&typeof(F[C-3])==R&&typeof(F[C-4])==b){H=F[C-1];m=F[C-2];I=F[C-3];k=F[C-4];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];F.length-=4}else if(typeof(F[C-1])==R&&typeof(F[C-2])==$&&typeof(F[C-3])==b){H=F[C-1];m=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==$&&typeof(F[C-2])==R&&typeof(F[C-3])==b){m=F[C-1];I=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==R&&typeof(F[C-2])==R&&typeof(F[C-3])==b){H=F[C-1];I=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==R&&typeof(F[C-2])==b){I=F[C-1];k=F[C-2];delete F[C-1];delete F[C-2];F.length-=2}else if(typeof(F[C-1])==$&&typeof(F[C-2])==b){m=F[C-1];k=F[C-2];delete F[C-1];delete F[C-2];F.length-=2}else if(typeof(F[C-1])==b){k=F[C-1];delete F[C-1];F.length--}var _=new Y(B.TagCall),o=(H?new V(_):new Q(_));o.writeString(l);if(F.length>0||I){o.reset();o.writeList(F);if(I)o.writeBoolean(true)}_.write(B.TagEnd);var h=_.toString();if(k){var d=S.length;return S[d]=P(n,D,h,W,g,E,i,f,function($){try{var _=a($,l,F,m)}catch(A){if(N)N(l,A);else U.onError(l,A);return}k(_,F);delete S[d]})}else{var Z=P(n,D,h,W,g,E,i,f);return a(Z,l,F,m)}}if(typeof(d)==N)this.useService(d,C)}a.create=function(_,$){return new a(_,$,true)};a.keepSession=function(){D=true;if(Session("HPROSE_COOKIE_MANAGER"))C=Session("HPROSE_COOKIE_MANAGER")};return a})()