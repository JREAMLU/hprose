/*
 * Compressed by JSA(www.xidea.org)
 */
var HproseResultMode={Normal:0,Serialized:1,Raw:2,RawWithEndTag:3};function HproseException($){this.message=$;this.description=$}HproseException.prototype=new Error;HproseException.prototype.name="HproseException";function HproseFilter(){this.inputFilter=function($){return $};this.outputFilter=function($){return $}}var HproseUtil={isDictionary:function($){return(($!=null)&&(typeof($)=="object")&&($ instanceof ActiveXObject)&&(typeof($.Add)=="unknown")&&(typeof($.Exists)=="unknown")&&(typeof($.Items)=="unknown")&&(typeof($.Keys)=="unknown")&&(typeof($.Remove)=="unknown")&&(typeof($.RemoveAll)=="unknown")&&(typeof($.Count)=="number")&&(typeof($.Item)=="unknown")&&(typeof($.Key)=="unknown"))},isVBArray:function($){return(($!=null)&&(typeof($)=="unknown")&&($.constructor==VBArray)&&(typeof($.dimensions)=="function")&&(typeof($.getItem)=="function")&&(typeof($.lbound)=="function")&&(typeof($.toArray)=="function")&&(typeof($.ubound)=="function"))},toObject:function(_){var B=(new VBArray(_.Keys())).toArray(),$={};for(var A=0;A<B.length;A++)if(this.isDictionary(_(B[A])))$[B[A]]=this.toObject(_(B[A]));else if(this.isVBArray(_(B[A])))$[B[A]]=this.toJSArray(_(B[A]));else $[B[A]]=_(B[A]);return $},toDictionary:function(_){var A,$;$=new ActiveXObject("Scripting.Dictionary");for(A in _)$.Add(A,_[A]);return $},toJSArray:function(_){function A($,C,E){var B=$.dimensions();if(B>C){E[C]=0;C++}var F=$.lbound(C),D=$.ubound(C),_=[];for(var G=F;G<=D;G++){E[C-1]=G;if(B==C)_[G]=$.getItem.apply($,E);else _[G]=A($,C,E)}return _}var $=new VBArray(_);if($.dimensions()==1&&$.lbound()==0)return $.toArray();return A($,0,[])},toVBArray:function($){return this.toDictionary($).Items()},binaryToString:function(_,C){try{var D=2,$=1,B=new ActiveXObject("ADODB.Stream");B.Type=$;B.Open();B.Write(_);B.Position=0;B.Type=D;if(C)B.CharSet=C;else B.CharSet="UTF-8";return B.ReadText()}catch(A){return""}}};function HproseStringInputStream($){var A=0,_=$.length;this.getc=function(){return $.charAt(A++)};this.read=function(B){var _=$.substr(A,B);this.skip(B);return _};this.skip=function($){A+=$};this.readuntil=function(C){var D=$.indexOf(C,A),B;if(D!==-1){B=$.substr(A,D-A);A=D+C.length}else{B=$.substr(A);A=_}return B};this.rawData=function(){return $}}function HproseStringOutputStream($){if($===undefined)$="";var _=[$],A=_.length;this.write=function($){_[A++]=$};this.mark=function(){$=this.toString()};this.reset=function(){_=[$]};this.clear=function(){_=[]};this.toString=function(){return _.join("")}}var HproseTags={TagInteger:"i",TagLong:"l",TagDouble:"d",TagNull:"n",TagEmpty:"e",TagTrue:"t",TagFalse:"f",TagNaN:"N",TagInfinity:"I",TagDate:"D",TagTime:"T",TagUTC:"Z",TagUTF8Char:"u",TagString:"s",TagGuid:"g",TagList:"a",TagMap:"m",TagClass:"c",TagObject:"o",TagRef:"r",TagPos:"+",TagNeg:"-",TagSemicolon:";",TagOpenbrace:"{",TagClosebrace:"}",TagQuote:"\"",TagPoint:".",TagFunctions:"F",TagCall:"C",TagResult:"R",TagArgument:"A",TagError:"E",TagEnd:"z"},HproseClassManager=new(function(){var _={},$=new ActiveXObject("Scripting.Dictionary");this.register=function(A,B){$.Item(A)=B;_[B]=A};this.getClassAlias=function(_){return $.Item(_)};this.getClass=function($){return _[$]};this.register(Object,"Object")})(),HproseRawReader,HproseSimpleReader,HproseReader,HproseSimpleWriter,HproseWriter;(function(){function freeEval(str){return eval(str)}(function(){var J=HproseUtil,Q=HproseTags,H=HproseException,K=HproseClassManager;function D(B,_){var $=B.length;for(var A=0;A<$;A++)if(B[A]===_)return A;return-1}function L(B,D,F,A){if(F<D.length){var E=D[F];B[E]=A;var _=L(B,D,F+1,".");if(F+1<D.length)if(_==null)_=L(B,D,F+1,"_");return _}var C=B.join("");try{if(freeEval("typeof("+C+") == \"function\""))return freeEval(C);else return null}catch($){return null}}function $(A){var $=K.getClass(A);if($)return $;if(freeEval("typeof("+A+") == \"function\"")){$=freeEval(A);K.register($,A);return $}var B=[],C=A.indexOf("_");while(C>-1){B[B.length]=C;C=A.indexOf("_",C+1)}if(B.length>0){var _=A.split("");$=L(_,B,0,".");if($==null)$=L(_,B,0,"_");if($!=null){K.register($,A);return $}}$=function(){this.getClassName=function(){return A}};K.register($,A);return $}var B=function(){var $={};for(var _ in[])$[_]=true;return $}(),_=function(){var $={};for(var _ in{})$[_]=true;return $}();function F($){switch($.toString()){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return true}return false}function N($){var _=$.length;for(var A=($.charAt(0)=="-")?1:0;A<_;A++)if(!F($.charAt(A)))return false;return($!="-")}function C(_){var $=_.toString(),A=$.length;return((A<12)&&N($)&&!(_<-2147483648||_>2147483647))}function P($){return(Object.prototype.toString.apply($)==="[object Array]")}function E(B){if(B===undefined||B.constructor===undefined)return"Object";var $=B.constructor,A=K.getClassAlias($);if(A)return A;var _=$.toString();A=_.substr(0,_.indexOf("(")).replace(/(^\s*function\s*)|(\s*$)/ig,"");if(A==""||A=="Object")return(typeof(B.getClassName)=="function")?B.getClassName():"Object";if(A!="Object")K.register($,A);return A}HproseRawReader=function A(_){function B(G,A){if(G===undefined)G=new HproseStringOutputStream();if(A===undefined)A=_.getc();switch(A){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case HproseTags.TagNull:case HproseTags.TagEmpty:case HproseTags.TagTrue:case HproseTags.TagFalse:case HproseTags.TagNaN:G.write(A);break;case HproseTags.TagInfinity:case HproseTags.TagUTF8Char:G.write(A);G.write(_.getc());break;case HproseTags.TagInteger:case HproseTags.TagLong:case HproseTags.TagDouble:case HproseTags.TagRef:D(G,A);break;case HproseTags.TagDate:case HproseTags.TagTime:C(G,A);break;case HproseTags.TagString:E(G,A);break;case HproseTags.TagGuid:F(G,A);break;case HproseTags.TagList:case HproseTags.TagMap:case HproseTags.TagObject:$(G,A);break;case HproseTags.TagClass:$(G,A);B(G);break;case HproseTags.TagError:G.write(A);B(G);break;case"":throw new H("No byte found in stream");default:throw new H("Unexpected serialize tag '"+A+"' in stream")}return G}function D(A,$){A.write($);do{$=_.getc();A.write($)}while($!=HproseTags.TagSemicolon)}function C(A,$){A.write($);do{$=_.getc();A.write($)}while($!=HproseTags.TagSemicolon&&$!=HproseTags.TagUTC)}function E(C,A){C.write(A);var $=_.readuntil(HproseTags.TagQuote);C.write($);C.write(HproseTags.TagQuote);var B=0;if($.length>0)B=parseInt($);C.write(_.read(B+1))}function F(A,$){A.write($);A.write(_.read(38))}function $(A,$){A.write($);do{$=_.getc();A.write($)}while($!=HproseTags.TagOpenbrace);while(($=_.getc())!=HproseTags.TagClosebrace)B(A,$);A.write($)}this.readRaw=B};HproseSimpleReader=function I(C,O){HproseRawReader.call(this,C);var V=[];function B(_,$){if($===undefined)$=C.getc();if($!=_)throw new H("Tag '"+_+"' expected, but '"+$+"' found in stream")}function G($,_){if(_===undefined)_=C.getc();if($.indexOf(_)>=0)return _;throw new H("Tags '"+$+"' expected, but '"+_+"' found in stream")}function _(_){var $=C.readuntil(_);if($.length==0)return 0;return parseInt($)}function U($){if($===undefined)$=C.getc();switch($){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return parseInt($);case Q.TagInteger:return R();case Q.TagLong:return P();case Q.TagDouble:return d();case Q.TagNull:return null;case Q.TagEmpty:return"";case Q.TagTrue:return true;case Q.TagFalse:return false;case Q.TagNaN:return NaN;case Q.TagInfinity:return b();case Q.TagDate:return this.readDate();case Q.TagTime:return this.readTime();case Q.TagUTF8Char:return C.getc();case Q.TagString:return this.readString();case Q.TagGuid:return this.readGuid();case Q.TagList:return this.readList();case Q.TagMap:return this.readMap();case Q.TagClass:this.readClass();return this.unserialize();case Q.TagObject:return this.readObject();case HproseTags.TagError:throw new H(this.readString(true));case"":throw new H("No byte found in stream");default:throw new H("Unexpected serialize tag '"+$+"' in stream")}}function R($){if($){var A=C.getc();if((A>="0")&&(A<="9"))return parseInt(A);B(Q.TagInteger,A)}return _(Q.TagSemicolon)}function P($){if($){var _=C.getc();if((_>="0")&&(_<="9"))return _;B(Q.TagLong,_)}return C.readuntil(Q.TagSemicolon)}function d($){if($){var _=C.getc();if((_>="0")&&(_<="9"))return parseFloat(_);B(Q.TagDouble,_)}return parseFloat(C.readuntil(Q.TagSemicolon))}function E(){B(Q.TagNaN);return NaN}function b($){if($)B(Q.TagInfinity);return((C.getc()==Q.TagNeg)?-Infinity:Infinity)}function Z(){B(Q.TagNull);return null}function D(){B(Q.TagEmpty);return""}function K(){var $=G(Q.TagTrue+Q.TagFalse);return($==Q.TagTrue)}function Y(A){if(A)B(Q.TagDate);var G=parseInt(C.read(4)),F=parseInt(C.read(2))-1,I=parseInt(C.read(2)),J,E=C.getc();if(E==Q.TagTime){var H=parseInt(C.read(2)),$=parseInt(C.read(2)),_=parseInt(C.read(2)),D=0;E=C.getc();if(E==Q.TagPoint){D=parseInt(C.read(3));E=C.getc();if((E>="0")&&(E<="9")){C.skip(2);E=C.getc();if((E>="0")&&(E<="9")){C.skip(2);E=C.getc()}}}if(E==Q.TagUTC)J=new Date(Date.UTC(G,F,I,H,$,_,D));else J=new Date(G,F,I,H,$,_,D)}else if(E==Q.TagUTC)J=new Date(Date.UTC(G,F,I));else J=new Date(G,F,I);if(O)J=J.getVarDate();return J}function S(D){if(D)B(Q.TagTime);var _,G=parseInt(C.read(2)),$=parseInt(C.read(2)),A=parseInt(C.read(2)),F=0,E=C.getc();if(E==Q.TagPoint){F=parseInt(C.read(3));E=C.getc();if((E>="0")&&(E<="9")){C.skip(2);E=C.getc();if((E>="0")&&(E<="9")){C.skip(2);E=C.getc()}}}if(E==Q.TagUTC){if(O)_=new Date(Date.UTC(1899,11,30,G,$,A,F)).getVarDate();else _=new Date(Date.UTC(1970,0,1,G,$,A,F))}else if(O)_=new Date(1899,11,30,G,$,A,F).getVarDate();else _=new Date(1970,0,1,G,$,A,F);return _}function f($){if($)B(Q.TagUTF8Char);return C.getc()}function T(A){if(A)B(Q.TagString);var $=C.read(_(Q.TagQuote));C.skip(1);return $}function X(_){if(_)B(Q.TagGuid);C.skip(1);var $=C.read(36);C.skip(1);return $}function A(){return[]}function h(A){var $=_(Q.TagOpenbrace);for(var B=0;B<$;B++)A[B]=this.unserialize();C.skip(1);if(O)A=J.toVBArray(A);return A}function L($){if($)B(Q.TagList);return this.readListEnd(this.readListBegin())}function g(){if(O)return new ActiveXObject("Scripting.Dictionary");return{}}function N(B){var $=_(Q.TagOpenbrace);for(var E=0;E<$;E++){var D=this.unserialize(),A=this.unserialize();if(O)B.Add(D,A);else B[D]=A}C.skip(1);return B}function a($){if($)B(Q.TagMap);return this.readMapEnd(this.readMapBegin())}function c(){var $=V[_(Q.TagOpenbrace)],A=new $.classname();return{obj:A,cls:$}}function e(_,$){for(var A=0;A<$.count;A++)_[$.fields[A]]=this.unserialize();C.skip(1);return _}function W(_){if(_){var A=G(Q.TagClass+Q.TagObject);if(A==Q.TagClass){this.readClass();return this.readObject(true)}}var $=this.readObjectBegin();return this.readObjectEnd($.obj,$.cls)}function F(){var B=T(),A=_(Q.TagOpenbrace),E=[];for(var D=0;D<A;D++)E[D]=this.readString(true);C.skip(1);B=$(B);V[V.length]={classname:B,count:A,fields:E}}function M(){V.length=0}this.checkTag=B;this.checkTags=G;this.unserialize=U;this.readInteger=R;this.readLong=P;this.readDouble=d;this.readNaN=E;this.readInfinity=b;this.readNull=Z;this.readEmpty=D;this.readBoolean=K;this.readDate=Y;this.readTime=S;this.readUTF8Char=f;this.readString=T;this.readListBegin=A;this.readListEnd=h;this.readList=L;this.readMapBegin=g;this.readMapEnd=N;this.readMap=a;this.readObjectBegin=c;this.readObjectEnd=e;this.readObject=W;this.readClass=F;this.reset=M};HproseReader=function G(C,_){HproseSimpleReader.call(this,C,_);var A=[];function $(_){var $=C.readuntil(_);if($.length==0)return 0;return parseInt($)}function B(){return A[$(Q.TagSemicolon)]}var F=this.unserialize;this.unserialize=function($){if($===undefined)$=C.getc();if($==Q.TagRef)return B();return F.call(this,$)};var J=this.readDate;this.readDate=function($){if($){var _=this.checkTags(Q.TagDate+Q.TagRef);if(_==Q.TagRef)return B()}var C=J();A[A.length]=C;return C};var D=this.readTime;this.readTime=function(_){if(_){var C=this.checkTags(Q.TagTime+Q.TagRef);if(C==Q.TagRef)return B()}var $=D();A[A.length]=$;return $};var E=this.readString;this.readString=function(_){if(_){var C=this.checkTags(Q.TagString+Q.TagRef);if(C==Q.TagRef)return B()}var $=E();A[A.length]=$;return $};var I=this.readGuid;this.readGuid=function(_){if(_){var C=this.checkTags(Q.TagGuid+Q.TagRef);if(C==Q.TagRef)return B()}var $=I();A[A.length]=$;return $};this.readList=function($){if($){var C=this.checkTags(Q.TagList+Q.TagRef);if(C==Q.TagRef)return B()}var E=this.readListBegin(),D=A.length;A[D]=E;E=this.readListEnd(E);if(_)A[D]=E;return E};this.readMap=function($){if($){var _=this.checkTags(Q.TagMap+Q.TagRef);if(_==Q.TagRef)return B()}var C=this.readMapBegin();A[A.length]=C;return this.readMapEnd(C)};this.readObject=function(_){if(_){var C=this.checkTags(Q.TagClass+Q.TagObject+Q.TagRef);if(C==Q.TagRef)return B();if(C==Q.TagClass){this.readClass();return this.readObject(true)}}var $=this.readObjectBegin();A[A.length]=$.obj;return this.readObjectEnd($.obj,$.cls)};var H=this.reset;this.reset=function(){H();A.length=0}};HproseSimpleWriter=function O($){var Z={},e=[];function X(A){if(A===undefined||A===null||A.constructor==Function)return I();if(A==="")return d();if(typeof(A)=="date")return G(A);if(J.isDictionary(A))return P(A);if(J.isVBArray(A))A=J.toJSArray(A);switch(A.constructor){case Boolean:f(A);break;case Number:F(A)?$.write(A):C(A)?W(A):K(A);break;case String:A.length==1?b(A):this.writeString(A,true);break;case Date:this.writeDate(A,true);break;default:if(Array.isArray(A))this.writeList(A,true);else{var _=E(A);if(_=="Object")this.writeMap(A,true);else this.writeObject(A,true)}}}function W(_){$.write(Q.TagInteger+_+Q.TagSemicolon)}function L(_){$.write(Q.TagLong+_+Q.TagSemicolon)}function K(_){if(isNaN(_))g();else if(isFinite(_))$.write(Q.TagDouble+_+Q.TagSemicolon);else a(_>0)}function g(){$.write(Q.TagNaN)}function a(_){$.write(Q.TagInfinity+(_?Q.TagPos:Q.TagNeg))}function I(){$.write(Q.TagNull)}function d(){$.write(Q.TagEmpty)}function f(_){$.write(_?Q.TagTrue:Q.TagFalse)}function H(G){var D=("0000"+G.getUTCFullYear()).slice(-4),C=("00"+(G.getUTCMonth()+1)).slice(-2),F=("00"+G.getUTCDate()).slice(-2),E=("00"+G.getUTCHours()).slice(-2),_=("00"+G.getUTCMinutes()).slice(-2),A=("00"+G.getUTCSeconds()).slice(-2),B=("000"+G.getUTCMilliseconds()).slice(-3);$.write(Q.TagDate+D+C+F+Q.TagTime+E+_+A);if(B!="000")$.write(Q.TagPoint+B);$.write(Q.TagUTC)}function V(I,J,H,A){var E=("0000"+I.getFullYear()).slice(-4),D=("00"+(I.getMonth()+1)).slice(-2),G=("00"+I.getDate()).slice(-2),F=("00"+I.getHours()).slice(-2),_=("00"+I.getMinutes()).slice(-2),B=("00"+I.getSeconds()).slice(-2),C=("000"+I.getMilliseconds()).slice(-3);if((F=="00")&&(_=="00")&&(B=="00")&&(C=="000"))$.write(Q.TagDate+E+D+G);else if((E==J)&&(D==H)&&(G==A)){$.write(Q.TagTime+F+_+B);if(C!="000")$.write(Q.TagPoint+C)}else{$.write(Q.TagDate+E+D+G+Q.TagTime+F+_+B);if(C!="000")$.write(Q.TagPoint+C)}$.write(Q.TagSemicolon)}function G($){V(new Date($),"1899","12","30")}function D($){V($,"1970","01","01")}function R(A){var D=("00"+A.getHours()).slice(-2),_=("00"+A.getMinutes()).slice(-2),B=("00"+A.getSeconds()).slice(-2),C=("000"+A.getMilliseconds()).slice(-3);$.write(Q.TagTime+D+_+B);if(C!="000")$.write(Q.TagPoint+C);$.write(Q.TagSemicolon)}function b(_){$.write(Q.TagUTF8Char+_)}function c(_){$.write(Q.TagString+(_.length>0?_.length:"")+Q.TagQuote+_+Q.TagQuote)}function Y(A){var _=A.length;$.write(Q.TagList+(_>0?_:"")+Q.TagOpenbrace);for(var B=0;B<_;B++)this.serialize(A[B]);$.write(Q.TagClosebrace)}function P(_){var C=(new VBArray(_.Keys())).toArray(),A=C.length;$.write(Q.TagMap+(A>0?A:"")+Q.TagOpenbrace);for(var B=0;B<A;B++){X(C[B]);X(_.Item(C[B]))}$.write(Q.TagClosebrace)}function A(C){var F=[];for(var D in C)if(typeof(C[D])!="function"&&(typeof(C[D])!="unknown"||J.isVBArray(C[D]))&&!_[D]&&!B[D])F[F.length]=D;var A=F.length;$.write(Q.TagMap+(A>0?A:"")+Q.TagOpenbrace);for(var E=0;E<A;E++){this.serialize(F[E]);this.serialize(C[F[E]])}$.write(Q.TagClosebrace)}function U(C){var B=E(C),A=Z[B],F;if(A!==undefined)F=e[A];else{F=[];for(var D in C)if(typeof(C[D])!="function"&&!_[D])F[F.length]=D.toString();A=S.call(this,B,F)}$.write(Q.TagObject+A+Q.TagOpenbrace);return F}function M(A,C){var _=C.length;for(var B=0;B<_;B++)this.serialize(A[C[B]]);$.write(Q.TagClosebrace)}function N($){this.writeObjectEnd($,this.writeObjectBegin($))}function S(B,D){var A=D.length;$.write(Q.TagClass+B.length+Q.TagQuote+B+Q.TagQuote+(A>0?A:"")+Q.TagOpenbrace);for(var C=0;C<A;C++)this.writeString(D[C]);$.write(Q.TagClosebrace);var _=e.length;Z[B]=_;e[_]=D;return _}function T(){Z={};e.length=0}this.serialize=X;this.writeInteger=W;this.writeLong=L;this.writeDouble=K;this.writeNaN=g;this.writeInfinity=a;this.writeNull=I;this.writeEmpty=d;this.writeBoolean=f;this.writeUTCDate=H;this.writeVBSDate=G;this.writeDate=D;this.writeTime=R;this.writeUTF8Char=b;this.writeString=c;this.writeList=Y;this.writeDict=P;this.writeMap=A;this.writeObjectBegin=U;this.writeObjectEnd=M;this.writeObject=N;this.reset=T};HproseWriter=function M($){HproseSimpleWriter.call(this,$);var G=new ActiveXObject("Scripting.Dictionary"),C=0,K=function(D,E,B,A){if(E&&G.Exists(D))$.write(Q.TagRef+G.Item(D)+Q.TagSemicolon);else{var _=B.call(this,D);G.Item(D)=C++;A.call(this,D,_)}},J=this.reset;this.reset=function(){J();G.RemoveAll();C=0};function L(){}var E=this.writeUTCDate;this.writeUTCDate=function(_,$){K.call(this,_,$,L,E)};var D=this.writeVBSDate;this.writeVBSDate=function(_,$){K.call(this,_,$,L,D)};var A=this.writeDate;this.writeDate=function(_,$){K.call(this,_,$,L,A)};var H=this.writeTime;this.writeTime=function($,_){K.call(this,$,_,L,H)};var I=this.writeString;this.writeString=function($,_){K.call(this,$,_,L,I)};var B=this.writeList;this.writeList=function($,_){K.call(this,$,_,L,B)};var F=this.writeDict;this.writeDict=function(_,$){K.call(this,_,$,L,F)};var _=this.writeMap;this.writeMap=function($,A){K.call(this,$,A,L,_)};this.writeObject=function($,_){K.call(this,$,_,this.writeObjectBegin,this.writeObjectEnd)}}})()})();var HproseFormatter={serialize:function(B,_){var $=new HproseStringOutputStream(),A=(_?new HproseSimpleWriter($):new HproseWriter($));A.serialize(B);return $.toString()},unserialize:function(B,_){var $=new HproseStringInputStream(B),A=(_?new HproseSimpleReader($):new HproseReader($));return A.unserialize()}},HproseHttpClient=(function(){var J=HproseResultMode,Z=HproseException,I=HproseFilter,H=HproseStringInputStream,Y=HproseStringOutputStream,X=HproseSimpleReader,F=HproseReader,V=HproseSimpleWriter,Q=HproseWriter,B=HproseTags,d=HproseFormatter,E="undefined",R="boolean",N="string",$="number",b="function",G="_OnError",K="_onError",A="_onerror",O="_Callback",e="_callback",L="_OnSuccess",M="_onSuccess",T="_onsuccess",D=false,C={},W=null;function _(){if(W!=null)return new ActiveXObject(W);else{var $=["MSXML2.ServerXMLHTTP.6.0","MSXML2.ServerXMLHTTP.5.0","MSXML2.ServerXMLHTTP.4.0","MSXML2.ServerXMLHTTP.3.0","MSXML2.ServerXMLHTTP"],B=$.length,A;for(var C=0;C<B;C++){try{A=new ActiveXObject($[C]);W=$[C];return A}catch(_){}}return null}}function c(_,A){for(var I=0;I<_.length;I++){var H=_[I].split(":",2),B=H[0].toLowerCase(),E=H[1];if((B=="set-cookie")||(B=="set-cookie2")){var G=E.replace(/(^\s*)|(\s*$)/g,"").split(";"),$={};E=G[0].replace(/(^\s*)|(\s*$)/g,"").split("=",2);if(E[1]===undefined)E[1]=null;$["name"]=E[0];$["value"]=E[1];for(var F=1;F<G.length;F++){E=G[F].replace(/(^\s*)|(\s*$)/g,"").split("=",2);if(E[1]===undefined)E[1]=null;$[E[0].toUpperCase()]=E[1]}if($["PATH"]){if($["PATH"].charAt(0)=="\"")$["PATH"]=$["PATH"].substr(1);if($["PATH"].charAt($["PATH"].length-1)=="\"")$["PATH"]=$["PATH"].substr(0,$["PATH"].length-1)}else $["PATH"]="/";if($["EXPIRES"])$["EXPIRES"]=Date.parse($["EXPIRES"]);if($["DOMAIN"])$["DOMAIN"]=$["DOMAIN"].toLowerCase();else $["DOMAIN"]=A;$["SECURE"]=($["SECURE"]!==undefined);if(C[$["DOMAIN"]]===undefined)C[$["DOMAIN"]]={};C[$["DOMAIN"]][$["name"]]=$;if(D)Session("HPROSE_COOKIE_MANAGER")=C}}}function S(_,F,E){var G=[];for(var D in C)if(_.indexOf(D)>-1){var A=[];for(var B in C[D]){var $=C[D][B];if($["EXPIRES"]&&((new Date()).getTime()>$["EXPIRES"]))A.push(B);else if(F.indexOf($["PATH"])===0)if(((E&&$["SECURE"])||!$["SECURE"])&&($["value"]!==null))G.push($["name"]+"="+$["value"])}for(var H in A)delete C[D][A[H]]}if(G.length>0)return G.join("; ");return""}function U(C,_,D){if(C.status==200){var $=C.getAllResponseHeaders().split("\r\n");c($,_);return D.inputFilter(C.responseText)}else{var A=C.status+":"+C.statusText;return B.TagError+d.serialize(A,true)+B.TagEnd}}function P(F,G,D,K,$,O,P,Q,L){var B,M,C,J;if(F.substr(0,7).toLowerCase()=="http://"){C=false;J=7}else if(F.substr(0,8).toLowerCase()=="https://"){C=true;J=8}if(J>0){B=F.substring(J,F.indexOf("/",J));var E=B.match(/^([^:]*):([^@]*)@(.*)$/);if(E!=null)B=E[3];M=F.substr(F.indexOf("/",J))}else throw new Z("Url must be an absolute path.");var N=_();N.setTimeouts(P,P,P,P);if(K){try{N.setProxy(2,K);if($)N.setProxyCredentials($,O)}catch(A){}}if(L){N.open("POST",F,true);N.onreadystatechange=function(){if(N.readyState==4)L(U(N,B,Q))}}else N.open("POST",F,false);for(var I in G)N.setRequestHeader(I,G[I]);var H=S(B,M,C);if(H!="")N.setRequestHeader("Cookie",H);N.send(Q.outputFilter(D));if(L)return N;else return U(N,B,Q)}function a(d,C,_){var D={"Content-Type":"application/hprose; charset=utf-8"},n,W,g,E,i=30000,j=false,c=false,S=[],f=new I(),U=this;this.useService=function(B,$,A){if(typeof($)==R&&A===undefined)A=$;var _=this;if(A)_={};if(B===undefined)return new Z("You should set server url first!");n=B;if(typeof($)==N||($&&$.constructor==Object))$=[$];if(Object.prototype.toString.apply($)==="[object Array]")o.call(_,$);else k.apply(_);return _};this.invoke=function(){var $=arguments,_=Array.prototype.shift.apply($);return h.call(this,_,$)};this.setHeader=function(_,A){var $=_.toLowerCase();if($!="content-type"&&$!="content-length"&&$!="host")if(A)D[_]=A;else delete D[_]};this.setProxy=function(A,$,_,F){if(!A)W=null;else if($===undefined){var C=0;if(A.substr(0,7).toLowerCase()=="http://")C=7;else if(A.substr(0,6).toLowerCase()=="tcp://")C=6;var B=A.indexOf("/",C);if(B>0){A=A.substring(C,B);var D=A.match(/^([^:]*):([^@]*)@(.*)$/);if(D!=null){g=decodeURIComponent(D[1]);E=decodeURIComponent(D[2]);A=D[3]}}W=A}else{W=A+":"+$;if(_!==undefined&&F!==undefined){g=_;E=F}}};this.setTimeout=function($){i=$};this.getTimeout=function(){return i};this.getByRef=function(){return j};this.setByRef=function($){if($===undefined)$=true;j=$};this.setFilter=function($){f=$};this.getSimpleMode=function(){return c};this.setSimpleMode=function($){if($===undefined)$=true;c=$};this.onError=function(_,$){};this.waitForResponse=function(C){for(var D=0,B=S.length;D<B;D++)if(S[D]){var A=S[D];if(C===undefined)A.waitForResponse();else{if(C<0)return;var _=new Date();A.waitForResponse(C/1000);var $=new Date();C-=$.getTime()-_.getTime()}}};function k(){var $=P(n,D,B.TagEnd,W,g,E,i,f),C=new H($),G=new X(C,_),F=G.checkTags(B.TagFunctions+B.TagError);switch(F){case B.TagFunctions:var A=G.readList(true);G.checkTag(B.TagEnd);o.call(this,A);break;case B.TagError:throw new Z(G.readString(true));break}}function m(_){var $=this;return function(){return h.call($,_,arguments)}}function l(B,E,_,$){if(B[_]!==undefined)return;B[_]={};if(typeof($)==N||$.constructor==Object)$=[$];if(Object.prototype.toString.apply($)==="[object Array]")for(var D=0;D<$.length;D++){var C=$[D];if(typeof(C)==N)B[_][C]=m.call(this,E+_+"_"+C);else for(var A in C)l.call(this,B[_],_+"_",A,C[A])}}function o(_){for(var B=0;B<_.length;B++){var $=_[B];if(typeof($)==N){if(this[$]===undefined)this[$]=m($)}else for(var A in $)l.call(this,this,"",A,$[A])}}function a($,L,G,K){var A=null;if(K==J.RawWithEndTag)A=$;else if(K==J.Raw)A=$.substr(0,$.length-1);else{var C=new H($),M=new F(C,_),E,D=null;while((E=M.checkTags(B.TagResult+B.TagArgument+B.TagError+B.TagEnd))!==B.TagEnd)switch(E){case B.TagResult:if(K==J.Serialized)A=M.readRaw().toString();else A=M.unserialize();break;case B.TagArgument:M.reset();var I=M.readList(true);for(var N=0;N<I.length;N++)G[N]=I[N];break;case B.TagError:M.reset();D=new Z(M.readString(true));break}if(D!=null)throw D}return A}function h(l,F){var m=J.Normal,I=j,H=c,X=l.toLowerCase(),N=this[l+G]||this[l+K]||this[l+A]||this[X+G]||this[X+K]||this[X+A]||U[l+G]||U[l+K]||U[l+A]||U[X+G]||U[X+K]||U[X+A],k=this[l+O]||this[l+e]||this[l+L]||this[l+M]||this[l+T]||this[X+O]||this[X+e]||this[X+L]||this[X+M]||this[X+T]||U[l+O]||U[l+e]||U[l+L]||U[l+M]||U[l+T]||U[X+O]||U[X+e]||U[X+L]||U[X+M]||U[X+T],C=F.length;if(typeof(F[C-1])==R&&typeof(F[C-2])==$&&typeof(F[C-3])==R&&typeof(F[C-4])==b&&typeof(F[C-5])==b){H=F[C-1];m=F[C-2];I=F[C-3];N=F[C-4];k=F[C-5];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];delete F[C-5];F.length-=5}else if(typeof(F[C-1])==R&&typeof(F[C-2])==$&&typeof(F[C-3])==b&&typeof(F[C-4])==b){H=F[C-1];m=F[C-2];N=F[C-3];k=F[C-4];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];F.length-=4}else if(typeof(F[C-1])==$&&typeof(F[C-2])==R&&typeof(F[C-3])==b&&typeof(F[C-4])==b){m=F[C-1];I=F[C-2];N=F[C-3];k=F[C-4];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];F.length-=4}else if(typeof(F[C-1])==R&&typeof(F[C-2])==R&&typeof(F[C-3])==b&&typeof(F[C-4])==b){H=F[C-1];I=F[C-2];N=F[C-3];k=F[C-4];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];F.length-=4}else if(typeof(F[C-1])==R&&typeof(F[C-2])==b&&typeof(F[C-3])==b){I=F[C-1];N=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==$&&typeof(F[C-2])==b&&typeof(F[C-3])==b){m=F[C-1];N=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==b&&typeof(F[C-2])==b){N=F[C-1];k=F[C-2];delete F[C-1];delete F[C-2];F.length-=2}else if(typeof(F[C-1])==R&&typeof(F[C-2])==$&&typeof(F[C-3])==R&&typeof(F[C-4])==b){H=F[C-1];m=F[C-2];I=F[C-3];k=F[C-4];delete F[C-1];delete F[C-2];delete F[C-3];delete F[C-4];F.length-=4}else if(typeof(F[C-1])==R&&typeof(F[C-2])==$&&typeof(F[C-3])==b){H=F[C-1];m=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==$&&typeof(F[C-2])==R&&typeof(F[C-3])==b){m=F[C-1];I=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==R&&typeof(F[C-2])==R&&typeof(F[C-3])==b){H=F[C-1];I=F[C-2];k=F[C-3];delete F[C-1];delete F[C-2];delete F[C-3];F.length-=3}else if(typeof(F[C-1])==R&&typeof(F[C-2])==b){I=F[C-1];k=F[C-2];delete F[C-1];delete F[C-2];F.length-=2}else if(typeof(F[C-1])==$&&typeof(F[C-2])==b){m=F[C-1];k=F[C-2];delete F[C-1];delete F[C-2];F.length-=2}else if(typeof(F[C-1])==b){k=F[C-1];delete F[C-1];F.length--}var _=new Y(B.TagCall),o=(H?new V(_):new Q(_));o.writeString(l);if(F.length>0||I){o.reset();o.writeList(F);if(I)o.writeBoolean(true)}_.write(B.TagEnd);var h=_.toString();if(k){var d=S.length;return S[d]=P(n,D,h,W,g,E,i,f,function($){try{var _=a($,l,F,m)}catch(A){if(N)N(l,A);else U.onError(l,A);return}k(_,F);delete S[d]})}else{var Z=P(n,D,h,W,g,E,i,f);return a(Z,l,F,m)}}if(typeof(d)==N)this.useService(d,C)}a.create=function(_,$){return new a(_,$,true)};a.keepSession=function(){D=true;if(Session("HPROSE_COOKIE_MANAGER"))C=Session("HPROSE_COOKIE_MANAGER")};return a})()